<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Language_files/filelist.xml">
<title>Using Python on .NET</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Mark Hammond</o:Author>
  <o:LastAuthor>Mark Hammond</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>430</o:TotalTime>
  <o:Created>2001-05-04T05:57:00Z</o:Created>
  <o:LastSaved>2001-05-04T13:07:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>574</o:Words>
  <o:Characters>3276</o:Characters>
  <o:Company> </o:Company>
  <o:Lines>27</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>4023</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.Technical
	{mso-style-name:Technical;
	font-style:italic;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:1.0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Pre, li.Pre, div.Pre
	{mso-style-name:Pre;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:919677805;
	mso-list-type:hybrid;
	mso-list-template-ids:1252399254 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:1364747002;
	mso-list-type:hybrid;
	mso-list-template-ids:-740394012 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
</head>

<body lang=EN-AU link=blue vlink=purple style='tab-interval:36.0pt'>

<div class=Section1>

<h1>Using Python on .NET</h1>

<p class=MsoNormal>This document describes using Python on .NET.<span
style="mso-spacerun: yes">  </span>It describes the semantics of the language,
and differences between CPython and Python for .NET.</p>

<p class=MsoNormal>For more introductory information, see <a
href="introduction.html">the Python for .NET introduction</a>.<span
style="mso-spacerun: yes">  </span>For information on using the compiler itself,
see the <a href="PythonCompiler.html">compiler documentation</a>.</p>

<h2>Introduction</h2>

<p class=MsoNormal>Python for .NET supports most of the core Python language.<span
style="mso-spacerun: yes">  </span>As such, this document will make no attempt
to list everything that works like the existing Python implementation, but will
focus on any differences between the implementations.<span style="mso-spacerun:
yes">  </span>As a result, a basic understanding of Python is necessary before
understanding this document. </p>

<h2>Types</h2>

<p class=MsoNormal>All simple Python builtin types work as expected, with the
exception of Long Integers, Complex Numbers and Ellipses objects.<span
style="mso-spacerun: yes">  </span>Most builtin types have a full complement of
methods – for example, string, dictionary and list methods are fully supported.</p>

<h2>Functions</h2>

<p class=MsoNormal>.NET is a strongly typed runtime environment, and Python
does not have type declarations for any variables or parameters.<span
style="mso-spacerun: yes">  </span>In addition, Python defines semantics that
are not supported by .NET, such as keyword argument dictionaries.<span
style="mso-spacerun: yes">  </span>As a result, some special handling is
applied to all functions and methods in order to create an appropriate .NET
function signature.</p>

<p class=MsoNormal>The Python for .NET compiler needs to decide that .NET
signature to use for all generated functions and methods.<span
style="mso-spacerun: yes">  </span>The signature used for the function
determines how external applications can make calls to the functions, but there
are three distinct problems the compiler faces:</p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list 36.0pt'>No
     type declarations exist in the Python source code.</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list 36.0pt'>Python
     supports semantics that can not be described with .NET function signatures
     (notably the ability to pass multiple types to a single method, and
     keyword and variable arguments)</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list 36.0pt'>.NET
     supports method overloading (that is, the same method name supporting
     different signatures)</li>
</ul>

<p class=MsoNormal>As a result, the Python compiler will generate one of 2
basic signature types – <i>internal</i> signatures and <i>external</i>
signatures.<span style="mso-spacerun: yes">  </span><i>Internal</i> signatures
are generated using internal <i>PyObjects</i>, and thus can only be called by
other Python code.<span style="mso-spacerun: yes">  </span><i>External</i>
signatures are generated using more reasonable .NET signatures, and therefore
can be called by external clients.<span style="mso-spacerun: yes">  </span>All <i>internal</i>
signatures are identical regardless of the number of arguments specified for
the function – they all take exactly 3 <i>PyObject</i> parameters, and return a
<i>PyObject</i>.</p>

<p class=MsoNormal><span style="mso-spacerun: yes"> </span>The compiler will
always try to use an external signature, unless it meets one of two criteria</p>

<ul style='margin-top:0cm' type=disc>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list 36.0pt'>There
     is no reasonable way to represent the semantics using simple .NET types.<span
     style="mso-spacerun: yes">  </span>This includes methods using variable
     argument lists or keyword argument dictionaries.</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list 36.0pt'>There
     is no reasonable way the code could be reached by external code.<span
     style="mso-spacerun: yes">  </span>This includes all module level methods
     and lambdas or local functions.</li>
</ul>

<h3>Specifying type information</h3>

<p class=MsoNormal>If a public signature is generated, the compiler still needs
to determine the .NET types to use in the function signature.<span
style="mso-spacerun: yes">  </span>To this end, the compiler uses a number of
hints before defaulting to a basic, default signature.</p>

<p class=MsoNormal>The first thing the compiler does is look for some type
hints in the Python source code.<span style="mso-spacerun: yes">  </span>As the
basic CPython parser is used, no syntactic changes to the language could be
made, so the compiler looks for variables of a special name inside the function
to provide type information.</p>

<p class=MsoNormal>The compiler recognises two variables.<span
style="mso-spacerun: yes">  </span><i>_com_params_</i> is a string with a comma
separated list of .NET type names.<span style="mso-spacerun: yes">  </span><i>_com_return_type_</i>
is a string that holds the name of the .NET return type.<span
style="mso-spacerun: yes">  </span>In both cases, the type name should be a
fully qualified name, and may be any .NET type in any referenced assembly.<span
style="mso-spacerun: yes">  </span>The <a href="PythonCompiler.html">compiler documentation</a>
describes how to add references to .NET <span style="mso-spacerun:
yes"> </span>assemblies giving access to all the types in that assembly.</p>

<p class=MsoNormal>For example, the following Python code:</p>

<p class=Code>def func(self, name, num):<br>
<span style="mso-spacerun: yes">    </span>_com_params_=&quot;System.String, System.Int32&quot;<br>
<span style="mso-spacerun: yes">    </span>_com_return_type_=&quot;System.Int32&quot;<br>
<span style="mso-spacerun: yes">    </span>...</p>

<p class=MsoNormal>will generate a function with the .NET signature similar to
what would be generated by the C# compiler for</p>

<p class=Code>Int32 func(string name, Int32 num)</p>

<h3>Virtual method type information</h3>

<p class=MsoNormal>If no explicit type information is provided, the compiler
determines if the function being generated is a virtual method for a .NET base
class.<span style="mso-spacerun: yes">  </span>If so, it assumes that you are
attempting to provide an implementation for this method, and generates the
appropriate signature.</p>

<h3>Default signatures</h3>

<p class=MsoNormal>In the absence of any other hints, the Python compiler will
generate signatures using <i>System.Object</i> as parameter and return types.</p>

<h2>Classes</h2>

<p class=MsoNormal>The handling of classes by the .NET compiler deserves
special attention.<span style="mso-spacerun: yes">  </span>Like the discussion
on function and method objects, many of the considerations are a direct result
of a mismatch between Python and .NET semantics.</p>

<h3>Inheritance</h3>

<p class=MsoNormal>The compiler attempts to support two different styles of
inheritance.<span style="mso-spacerun: yes">  </span>The first is a <i>compile
time</i> inheritance, which uses standard .NET inheritance, and is the same as
supported by most other .NET languages such as Managed C++ or C#.<span
style="mso-spacerun: yes">  </span>The second is <i>a runtime inheritance</i>
that operates in much the same way as CPython.<span style="mso-spacerun: yes"> 
</span>Runtime inheritance is used whenever .NET semantics can not be supported
– the most obvious case being multiple inheritance.</p>

<p class=MsoNormal>If the compiler inherits from a base class using runtime
inheritance, external languages will not be able to access all functionality
implemented in the base class. </p>

<h3>Use of self in constructor</h3>

<p class=MsoNormal>In some cases, if you attempt to use <i>self</i> in a class
constructor before you have called any .NET base class constructors, you may get
.NET verification errors.</p>

<h3>Dynamic Attributes</h3>

<p class=MsoNormal>Many dynamic Python features do not work.<span
style="mso-spacerun: yes">  </span>Specifically, most “double-underscore”
Python methods (such as __getattr__, __repr__, etc) are not implemented.</p>

<h2>Exceptions</h2>

<p class=MsoNormal>Python exceptions are derived from the standard .NET <i>System.Exception</i>
class.<span style="mso-spacerun: yes">  </span>As a result, any .NET exception
can be caught and thrown by Python code.</p>

<h2>Builtins and Standard Library</h2>

<p class=MsoNormal>The support for builtin functions and the standard library
is quite sparse.<span style="mso-spacerun: yes">  </span>At this point in time,
the only reasonable strategy is to implement all built-ins and library modules either
using the Python for .NET compiler or using C#.</p>

<p class=MsoNormal>There is no attempt to list the builtin methods and modules
as it will soon be out of date.<span style="mso-spacerun: yes"> 
</span>Instead, you should browse the “builtins” and “library” directories in
the Python distribution.</p>

</div>

</body>

</html>
